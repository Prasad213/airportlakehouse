<?xml version="1.0" encoding="UTF-8" ?>
 <root>
     <bronze>
         <type>mysql</type>
         <read_params>
             <jdbcURL>jdbc:mysql://127.0.0.1:3306</jdbcURL>
             <username>prasad</username>
             <password>Suraj123</password>
             <database>airportdb_snap1</database>
             <driver>com.mysql.cj.jdbc.Driver</driver>
             <tables>airline</tables>
             <tables>airplane</tables>
             <tables>airplane_type</tables>
             <tables>airport</tables>
             <tables>airport_geo</tables>
             <tables>flight</tables>
             <tables>flightschedule</tables>
             <tables>passenger</tables>
             <tables>passengerdetails</tables>
         </read_params>
         <save_params>
             <path>s3a://bronze/airportdb/</path>
             <method>overwrite</method>
         </save_params>
     </bronze>
    <bronze>
        <type>csv</type>
        <read_params>
            <path>s3a://practice/source/booking.csv</path>
        </read_params>
        <save_params>
            <path>s3a://bronze/booking</path>
            <method>overwrite</method>
        </save_params>
    </bronze>
    <silver>
        <type>delta</type>
        <read_params>
            <bookingPath>
                <path>s3a://bronze/booking/</path>
            </bookingPath>
            <dbPath>
                <path>s3a://bronze/airportdb/</path>
            </dbPath>
            <tables>airline</tables>
            <tables>airport</tables>
            <tables>flight</tables>
            <tables>flightschedule</tables>
            <tables>passenger</tables>
            <tables>booking</tables>
        </read_params>
        <save_params>
            <schemaName>lakehouse.curatedairportdb</schemaName>
            <path>/silver/curatedairportdb/</path>
        </save_params>
    </silver>
    <gold>
        <type>delta</type>
        <params>
            <tables>
                <tableName>passengerdim</tableName>
                <sourceSchemaName>lakehouse.curatedairportdb</sourceSchemaName>
                <sourceTableName>passenger</sourceTableName>
                <targetSchemaName>airportlakehouse</targetSchemaName>
                <businessKey>passenger_id</businessKey>
            </tables>
            <tables>
                <tableName>airportdim</tableName>
                <sourceSchemaName>lakehouse.curatedairportdb</sourceSchemaName>
                <sourceTableName>airport</sourceTableName>
                <targetSchemaName>airportlakehouse</targetSchemaName>
                <businessKey>airport_id</businessKey>
            </tables>
            <tables>
                <tableName>flightscheduledim</tableName>
                <sourceSchemaName>lakehouse.curatedairportdb</sourceSchemaName>
                <sourceTableName>flightschedule</sourceTableName>
                <targetSchemaName>airportlakehouse</targetSchemaName>
                <businessKey>flightno</businessKey>
            </tables>
            <tables>
                <tableName>bookingfact</tableName>
                <sourceSchemaName>lakehouse.curatedairportdb</sourceSchemaName>
                <sourceTableName>airline,flight,booking</sourceTableName>
                <targetSchemaName>airportlakehouse</targetSchemaName>
                <businessKey>booking_id</businessKey>
            </tables>
        </params>
    </gold>
 </root>
